<!DOCTYPE html>

<html>
<head>
    <title>might as well hack it</title>
    <meta name="author" content="Guilherme P. GonÃ§alves"/>
    <meta http-equiv="content-type" content="text/html; charset=utf-8"/>
    <link rel="stylesheet" href="/css/common.css" type="text/css"/>
    <link rel="stylesheet" href="/css/syntax.css" type="text/css"/>
    <link rel="stylesheet" href="/css/post.css" type="text/css"/>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
</head>
<body>
    <script type="text/javascript">
        // Handle navigation between posts when 'h' or 'l' is pressed.
        function handleNavigate(e) {
            if (e.altKey || e.ctrlKey || e.shiftKey || e.metaKey) {
                return;
            }

            var to = null;
            var cmd = String.fromCharCode(e.which).toLowerCase();

            switch (cmd) {
                case 'h':
                    to = $("#next").attr("href");
                    break;
                case 'l':
                    to = $("#previous").attr("href");
                    break;
            }

            if (to) {
                window.location.href = to;
            }
        }

        // Handle scrolling when 'j' or 'k' is pressed.
        function handleScroll(e) {
            if (e.altKey || e.ctrlKey || e.shiftKey || e.metaKey) {
                return;
            }

            var speed = 10;
            var cmd = String.fromCharCode(e.which).toLowerCase();
            var pos = $(document).scrollTop();
            switch (cmd) {
                case 'j':
                    $(document).scrollTop(pos + speed);
                    break;
                case 'k':
                    $(document).scrollTop(pos - speed);
                    break;
            }
        }

        $(function() {
            // keypress events are level sensitive, so use them in case the
            // scrolling keys are held down instead of only pressed.
            $(document).keydown(handleNavigate).keypress(handleScroll);
        });
    </script>

    {% include top.html %}
    {% include sidebar.html %}

    <div id="post-content" class="column">
        <h1><a href="{{ page.url }}">{{ page.title }}</a></h1>
        {% if page.type != "page" %}
            <h2>Published {{ page.date | date_to_string }}</h2>
        {% endif %}
        <br/>

        {{ content }}

        {% if page.type != "page" %}
            <br/>
            {% assign previous = null %}
            {% assign next = null %}
            {% assign last = null %}

            {% for p in site.posts %}
                {% if page.id == p.id %}
                    {% assign next = last %}
                {% endif %}

                {% if page.id == last.id %}
                    {% assign previous = p %}
                {% endif %}

                {% assign last = p %}
            {% endfor %}

            {% if page.tags.size > 0 %}
                <div id="tags">
                    <em>Tags:</em>
                    <ul>
                        {% for tag in page.tags %}
                            {% assign url = "/tags.html" %}

                            {% if forloop.last %}
                                <li class="last">
                            {% else %}
                                <li>
                            {% endif %}

                            <a href="{{ url | append: '#' }}{{ tag | replace: ' ','-' }}">{{ tag }}</a>
                            </li>
                        {% endfor %}
                    </ul>
                </div>
            {% endif %}

            {% if next != null %}
                <a id="next" href={{next.url}}>Next</a>
            {% endif %}

            {% if previous != null %}
                <a id="previous" href={{previous.url}}>Previous</a>
            {% endif %}
        {% endif %}
    </div>
</body>
</html>
